{"ast":null,"code":"const noteMatrix = [[{\n  'number': 10,\n  'char': 'C𝄫'\n}, {\n  'number': 11,\n  'char': 'C♭'\n}, {\n  'number': 0,\n  'char': 'C'\n}, {\n  'number': 1,\n  'char': 'C♯'\n}, {\n  'number': 2,\n  'char': 'C𝄪'\n}], [{\n  'number': 0,\n  'char': 'D𝄫'\n}, {\n  'number': 1,\n  'char': 'D♭'\n}, {\n  'number': 2,\n  'char': 'D'\n}, {\n  'number': 3,\n  'char': 'D♯'\n}, {\n  'number': 4,\n  'char': 'D𝄪'\n}], [{\n  'number': 2,\n  'char': 'E𝄫'\n}, {\n  'number': 3,\n  'char': 'E♭'\n}, {\n  'number': 4,\n  'char': 'E'\n}, {\n  'number': 5,\n  'char': 'E♯'\n}, {\n  'number': 6,\n  'char': 'E𝄪'\n}], [{\n  'number': 3,\n  'char': 'F𝄫'\n}, {\n  'number': 4,\n  'char': 'F♭'\n}, {\n  'number': 5,\n  'char': 'F'\n}, {\n  'number': 6,\n  'char': 'F♯'\n}, {\n  'number': 7,\n  'char': 'F𝄪'\n}], [{\n  'number': 5,\n  'char': 'G𝄫'\n}, {\n  'number': 6,\n  'char': 'G♭'\n}, {\n  'number': 7,\n  'char': 'G'\n}, {\n  'number': 8,\n  'char': 'G♯'\n}, {\n  'number': 9,\n  'char': 'G𝄪'\n}], [{\n  'number': 7,\n  'char': 'A𝄫'\n}, {\n  'number': 8,\n  'char': 'A♭'\n}, {\n  'number': 9,\n  'char': 'A'\n}, {\n  'number': 10,\n  'char': 'A♯'\n}, {\n  'number': 11,\n  'char': 'A𝄪'\n}], [{\n  'number': 9,\n  'char': 'B𝄫'\n}, {\n  'number': 10,\n  'char': 'B♭'\n}, {\n  'number': 11,\n  'char': 'B'\n}, {\n  'number': 0,\n  'char': 'B♯'\n}, {\n  'number': 1,\n  'char': 'B𝄪'\n}]];\nconst positions = [[[0, 2], [6, 3], [1, 0]], [[1, 1], [0, 3], [6, 4]], [[1, 2], [2, 0], [0, 4]], [[2, 1], [1, 3], [3, 0]], [[2, 2], [3, 1], [1, 4]], [[3, 2], [2, 3], [4, 0]], [[4, 1], [3, 3], [2, 4]], [[4, 2], [5, 0], [3, 4]], [[5, 1], [4, 3]], [[5, 2], [6, 0], [4, 4]], [[6, 1], [5, 3], [0, 0]], [[6, 2], [0, 1], [5, 4]]];\nconst accTransform = a => {\n  // Function transforms y-index in matrix to degree of accidental. e.g. [0,1,2,3,4] -> [2,1,0,1,2]\n  return Math.abs(a - 2);\n};\nconst getChordType = (arr, i) => {\n  console.log(Math.abs(arr[i] - arr[(i + 2) % arr.length]), Math.abs(arr[(i + 2) % arr.length] - arr[(i + 4) % arr.length]));\n  return arr;\n};\nexport const pitchSpeller = (scales, transpose) => {\n  /*\n  Function returns correct character set for scale degree array. Only accepts heptatonic scales.\n  in: {'scaleName': [0,2,4,5,7,9,11]} -> out: {'scaleName': [{char: 'C', type: 'maj', num: 'I'}, {char: 'D', type: 'maj', num: 'II'}, ...]}\n  */\n\n  const outputArray = {};\n  Object.keys(scales).forEach(scaleName => {\n    const startPositions = positions[(scales[scaleName][0] + transpose) % 12];\n    const scaleLength = scales[scaleName].length;\n    var lowestCount = 999;\n    var winner = undefined;\n    for (let i = 0; i < startPositions.length; i++) {\n      const [sx, sy] = startPositions[i];\n\n      // if (i > 1) break\n\n      const resultArray = [];\n      var accidentalCount = 0;\n      for (let j = 0; j < scaleLength; j++) {\n        getChordType(scales[scaleName], j);\n        if (!j) {\n          resultArray.push({\n            \"char\": noteMatrix[sx][sy]['char'],\n            \"type\": null,\n            \"num\": null\n          });\n          accidentalCount += accTransform(sy);\n          continue;\n        }\n        const x = (j + sx) % scaleLength;\n        const matrixY = noteMatrix[x].map(obj => obj.number);\n        const transposedNote = (scales[scaleName][j] + transpose) % 12;\n        const indexY = matrixY.indexOf(transposedNote);\n        if (indexY === -1) {\n          accidentalCount = 999;\n          break;\n        }\n        resultArray.push({\n          \"char\": noteMatrix[x][indexY].char,\n          \"type\": null,\n          \"num\": null\n        });\n        accidentalCount += accTransform(indexY);\n      }\n      if (accidentalCount < lowestCount) {\n        lowestCount = accidentalCount;\n        winner = resultArray;\n      }\n    }\n    outputArray[scaleName] = winner;\n  });\n  return outputArray;\n};","map":{"version":3,"names":["noteMatrix","positions","accTransform","a","Math","abs","getChordType","arr","i","console","log","length","pitchSpeller","scales","transpose","outputArray","Object","keys","forEach","scaleName","startPositions","scaleLength","lowestCount","winner","undefined","sx","sy","resultArray","accidentalCount","j","push","x","matrixY","map","obj","number","transposedNote","indexY","indexOf","char"],"sources":["C:/Users/Levi/Desktop/portfolio/src/Chart/pitchSpeller.ts"],"sourcesContent":["const noteMatrix: Array<Array<{'number': number, 'char': string}>> = [\n  [{'number': 10,'char': 'C𝄫'}, {'number': 11,'char': 'C♭'}, {'number': 0, 'char': 'C'}, {'number': 1, 'char': 'C♯'}, {'number': 2, 'char': 'C𝄪'}],\n  [{'number': 0, 'char': 'D𝄫'}, {'number': 1, 'char': 'D♭'}, {'number': 2, 'char': 'D'}, {'number': 3, 'char': 'D♯'}, {'number': 4, 'char': 'D𝄪'}],\n  [{'number': 2, 'char': 'E𝄫'}, {'number': 3, 'char': 'E♭'}, {'number': 4, 'char': 'E'}, {'number': 5, 'char': 'E♯'}, {'number': 6, 'char': 'E𝄪'}],\n  [{'number': 3, 'char': 'F𝄫'}, {'number': 4, 'char': 'F♭'}, {'number': 5, 'char': 'F'}, {'number': 6, 'char': 'F♯'}, {'number': 7, 'char': 'F𝄪'}],\n  [{'number': 5, 'char': 'G𝄫'}, {'number': 6, 'char': 'G♭'}, {'number': 7, 'char': 'G'}, {'number': 8, 'char': 'G♯'}, {'number': 9, 'char': 'G𝄪'}],\n  [{'number': 7, 'char': 'A𝄫'}, {'number': 8, 'char': 'A♭'}, {'number': 9, 'char': 'A'}, {'number': 10,'char': 'A♯'}, {'number': 11,'char': 'A𝄪'}],\n  [{'number': 9, 'char': 'B𝄫'}, {'number': 10,'char': 'B♭'}, {'number': 11,'char': 'B'}, {'number': 0, 'char': 'B♯'}, {'number': 1, 'char': 'B𝄪'}],\n]\n\nconst positions: Array<Array<[number, number]>> = [\n  [[0,2], [6,3], [1,0]],\n  [[1,1], [0,3], [6,4]],\n  [[1,2], [2,0], [0,4]],\n  [[2,1], [1,3], [3,0]],\n  [[2,2], [3,1], [1,4]],\n  [[3,2], [2,3], [4,0]],\n  [[4,1], [3,3], [2,4]],\n  [[4,2], [5,0], [3,4]],\n  [[5,1], [4,3]],\n  [[5,2], [6,0], [4,4]],\n  [[6,1], [5,3], [0,0]],\n  [[6,2], [0,1], [5,4]],\n]\n\nconst accTransform = (a: number) => {\n  // Function transforms y-index in matrix to degree of accidental. e.g. [0,1,2,3,4] -> [2,1,0,1,2]\n  return Math.abs(a-2)\n}\n\nconst getChordType = (arr: number[], i: number) => {\n\n  console.log(Math.abs(arr[i] - arr[(i+2) % arr.length]), Math.abs(arr[(i+2) % arr.length] - arr[(i+4) % arr.length]))\n  return arr\n}\n\nexport const pitchSpeller = (scales: {[key: string]: number[]}, transpose: number) => {\n  /*\n  Function returns correct character set for scale degree array. Only accepts heptatonic scales.\n  in: {'scaleName': [0,2,4,5,7,9,11]} -> out: {'scaleName': [{char: 'C', type: 'maj', num: 'I'}, {char: 'D', type: 'maj', num: 'II'}, ...]}\n  */\n\n  const outputArray: any = {}\n\n  Object.keys(scales).forEach(scaleName => {\n    const startPositions = positions[(scales[scaleName][0] + transpose) % 12]\n    const scaleLength = scales[scaleName].length\n\n    var lowestCount = 999\n    var winner = undefined\n\n    for (let i = 0; i < startPositions.length; i++) {\n      const [sx, sy] = startPositions[i]\n\n      // if (i > 1) break\n\n      const resultArray = []\n      var accidentalCount = 0\n\n      for (let j = 0; j < scaleLength; j++) {\n\n        getChordType(scales[scaleName], j)\n\n        if (!j) {\n          resultArray.push({\"char\": noteMatrix[sx][sy]['char'], \"type\": null, \"num\": null})\n          accidentalCount += accTransform(sy)\n          continue\n        }\n        \n        const x = (j+sx)%scaleLength\n\n        const matrixY = noteMatrix[x].map(obj => obj.number)\n        \n        const transposedNote = (scales[scaleName][j] + transpose) % 12\n        const indexY = matrixY.indexOf(transposedNote)\n        if (indexY === -1) {\n          accidentalCount = 999\n          break\n        } \n        resultArray.push({\"char\": noteMatrix[x][indexY].char, \"type\": null, \"num\": null})\n        accidentalCount += accTransform(indexY)\n      }\n\n      if (accidentalCount < lowestCount) {\n        lowestCount = accidentalCount\n        winner = resultArray\n      }\n    }\n    outputArray[scaleName] = winner\n  })\n\n  return outputArray\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}